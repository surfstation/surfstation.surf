<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Current weather and surf conditions for St. Augustine Beach, FL 32080">
    <title>The Surf Station Weather</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans">
    <style>
      body {
        margin: 0px;
        border: 0px none #000000;
        padding: 0px;
        font-family: 'Open Sans', sans-serif;
        font-size: 14px;
        text-align: center;
        word-break: break-word;
      }

      header {
        background-color: #3a3a3a;
        line-height: 0px;
      }

      header > img {
        width: 100%;
        max-width: 288px;
      }

      div.card {
        width: 100%;
        max-width: 500px;
        margin: auto;
      }

      div.card > div.description {
        font-size: 16px;
        background-color: #00ffee;
        font-weight: 600;
      }

      div.card > div.imagecontentonly {
        line-height: 0px;
      }

      div.card img {
        width: 100%;
      }

      .showondata {
        display: none;
      }

      svg text {
        font-size: 70px;
        text-anchor: middle;
        fill: #ffffff;
      }

      svg line {
        stroke: #ffffff;
        stroke-width: 10;
        stroke-opacity: 0.75;
      }

      table {
        border-spacing: 0px;
        border-top: 1px solid #efefef;
        margin: auto;
      }

      td {
        padding: 10px;
        border-bottom: 1px solid #efefef;
      }

      ul {
        list-style-type: none;
        margin: auto;
        padding: 0px;
        width: fit-content;
      }

      ul li {
        padding: 10px;
        border-bottom: 1px solid #efefef;
      }

      iframe {
        width: 100%;
        min-height: 360px;
      }

      footer {
        background-color: #3a3a3a;
        color: #ffffff;
        clear: both;
      }

      @media (min-width: 600px) {
        div.card {
          max-width: 50%;
          float: left;
        }
      }

      @media (min-width: 1000px) {
        div.card {
          max-width: 33.333%;
          float: left;
        }
      }
    </style>
  </head>
  <body>
    <header><img src="/static/logo-1d27fdaadbcbcb2c6f99d146f57057eb.png"></header>
    <div class="card showondata">
      <div class="description">
        <div>Current Wind</div>
        <div>Last Updated: <span id="windInstant"></span></div>
      </div>
      <div class="imagecontentonly">
        <svg viewBox="0 0 1000 1000">
          <defs>
            <marker id="arrowEnd" markerWidth="8" markerHeight="8" refx="0" refy="4" orient="auto">
              <path d="M0,0 L8,4 L0,8 Z" style="fill: #000000; fill-opacity: 1;" />
            </marker>
            <marker id="circleEnd" markerWidth="6" markerHeight="6" refx="3" refy="3" orient="auto">
              <circle cx="3" cy="3" r="3" style="fill: #000000;" />
            </marker>
            <linearGradient id="dialGradient" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">
              <stop offset="20%" stop-color="#3a3a3a" stop-opacity="1" />
              <stop offset="100%" stop-color="#888888" stop-opacity="1" />
            </linearGradient>
          </defs>
          <circle cx="500" cy="500" r="500" style="fill: url(#dialGradient);" />
          <line id="windDirectionHand" x1="500" y1="500" x2="500" y2="80" marker-start="url(#circleEnd)" marker-end="url(#arrowEnd)" style="stroke: #000000; stroke-width: 10; stroke-opacity: 0.5;" />
          <line x1="500" y1="0" x2="500" y2="100" />
          <text style="font-size: 80px; text-anchor: middle;" x="500" y="180">N</text>
          <line x1="1000" y1="500" x2="900" y2="500" />
          <text style="font-size: 80px; text-anchor: end;" x="880" y="530">E</text>
          <line x1="500" y1="1000" x2="500" y2="900" />
          <text style="font-size: 80px; text-anchor: middle;" x="500" y="880">S</text>
          <line x1="0" y1="500" x2="100" y2="500" />
          <text style="font-size: 80px; text-anchor: start;" x="120" y="530">W</text>
          <line x1="146.4" y1="146.4" x2="181.8" y2="181.8" />
          <text style="font-size: 80px; text-anchor: start;" x="200" y="280">NW</text>
          <line x1="853.6" y1="146.4" x2="818.2" y2="181.8" />
          <text style="font-size: 80px; text-anchor: end;" x="800" y="280">NE</text>
          <line x1="146.4" y1="853.6" x2="181.8" y2="818.2" />
          <text style="font-size: 80px; text-anchor: start;" x="200" y="800">SW</text>
          <line x1="853.6" y1="853.6" x2="818.2" y2="818.2" />
          <text style="font-size: 80px; text-anchor: end;" x="800" y="800">SE</text>
          <text id="windDirectionDisplay" x="500" y="380"></text>
          <text id="windSpeedDisplay" x="500" y="680"></text>
        </svg>
      </div>
    </div>
    <div class="card showondata">
      <div class="description">
        <div>Wind Gust</div>
        <div>Last 10 Minutes</div>
      </div>
      <div class="imagecontentonly">
        <svg viewBox="0 0 1000 1000">
          <circle cx="500" cy="500" r="500" style="fill: url(#dialGradient);" />
          <line id="windGustDirectionHand" x1="500" y1="500" x2="500" y2="80" marker-start="url(#circleEnd)" marker-end="url(#arrowEnd)" style="stroke: #000000; stroke-width: 10; stroke-opacity: 0.5;" />
          <line x1="500" y1="0" x2="500" y2="100" />
          <text style="font-size: 80px; text-anchor: middle;" x="500" y="180">N</text>
          <line x1="1000" y1="500" x2="900" y2="500" />
          <text style="font-size: 80px; text-anchor: end;" x="880" y="530">E</text>
          <line x1="500" y1="1000" x2="500" y2="900" />
          <text style="font-size: 80px; text-anchor: middle;" x="500" y="880">S</text>
          <line x1="0" y1="500" x2="100" y2="500" />
          <text style="font-size: 80px; text-anchor: start;" x="120" y="530">W</text>
          <line x1="146.4" y1="146.4" x2="181.8" y2="181.8" />
          <text style="font-size: 80px; text-anchor: start;" x="200" y="280">NW</text>
          <line x1="853.6" y1="146.4" x2="818.2" y2="181.8" />
          <text style="font-size: 80px; text-anchor: end;" x="800" y="280">NE</text>
          <line x1="146.4" y1="853.6" x2="181.8" y2="818.2" />
          <text style="font-size: 80px; text-anchor: start;" x="200" y="800">SW</text>
          <line x1="853.6" y1="853.6" x2="818.2" y2="818.2" />
          <text style="font-size: 80px; text-anchor: end;" x="800" y="800">SE</text>
          <text id="windGustDirectionDisplay" x="500" y="380"></text>
          <text id="windGustSpeedDisplay" x="500" y="680"></text>
        </svg>
      </div>
    </div>
    <div class="card">
      <div class="description">Today's Tides</div>
      <div><ul id="tides"></ul></div>
    </div>
    <div class="card">
      <div class="description">Tomorrow's Tides</div>
      <div><ul id="tomorrowstides"></ul></div>
    </div>
    <div class="card">
      <div class="description">Daylight</div>
      <div>
        <table>
          <tr><td>First Light</td><td><span id="firstLight"></span></td></tr>
          <tr><td>Sunrise</td><td><span id="sunrise"></span></td></tr>
          <tr><td>Sunset</td><td><span id="sunset"></span></td></tr>
          <tr><td>Last Light</td><td><span id="lastLight"></span></td></tr>
        </table>
      </div>
    </div>
    <div class="card showondata">
      <div class="description">Local Observations</div>
      <div>
        <table>
          <tr><td>Temperature</td><td><span id="temperature"></span>&deg; F</td></tr>
          <tr><td>Humidity</td><td><span id="humidity"></span>%</td></tr>
        </table>
      </div>
    </div>
    <div class="card">
      <div class="description"><a href="https://cdip.ucsd.edu/m/products/?stn=194p1" target="_blank" rel="noopener noreferrer">Buoy</a></div>
      <div>
        <table>
          <tr><td>Swell Height</td><td><span id="buoy_swell_height_feet"></span> feet</td></tr>
          <tr><td>Swell Period</td><td><span id="buoy_swell_period_secs"></span> secs</td></tr>
          <tr><td>Surface Temp</td><td><span id="buoy_temperature_fahrenheit"></span>Â° F</td></tr>
          <tr>
            <td>Swell Angle</td>
            <td>
              <div><span id="buoy_swell_angle_degrees"></span>&deg;</div>
              <svg viewBox="0 0 1000 1000">
                <defs>
                  <marker id="swell_direction_arrow_end" markerWidth="8" markerHeight="8" refx="0" refy="4" orient="auto">
                    <path d="M0,0 L8,4 L0,8 Z" style="fill: #000000; fill-opacity: 1;" />
                  </marker>
                  <marker id="swell_direction_circle_end" markerWidth="6" markerHeight="6" refx="3" refy="3" orient="auto">
                    <circle cx="3" cy="3" r="3" style="fill: #000000;" />
                  </marker>
                </defs>
                <circle cx="500" cy="500" r="500" style="fill: #efefef;" />
                <line id="swell_angle_hand" x1="500" y1="500" x2="500" y2="80" marker-start="url(#swell_direction_circle_end)" marker-end="url(#swell_direction_arrow_end)" style="stroke: #000000; stroke-width: 10; stroke-opacity: 0.5;" />
              </svg>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="card">
      <div class="description">Pier North Cam</div>
      <div class="imagecontentonly">
        <iframe src="https://camstreamer.com/embed/Cwyc610HmMb53lJKweotlAb3biST7WgGWXfc8nd8?autoplay=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>
    <div class="card">
      <div class="description">Pier South Cam</div>
      <div class="imagecontentonly">
        <iframe src="https://camstreamer.com/embed/JULvJitzgQ31uxTEcBWFDxDcauow6FP93I3q8iSg?autoplay=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>
    <div class="card">
      <div class="description">3rd St Cam</div>
      <div class="imagecontentonly">
        <iframe src="https://camstreamer.com/yt-embed/68a2c2b1d0a16ce/S-29474?autoplay=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>
<!--
    <div class="card">
      <div class="description">Forecast</div>
      <div>
        <a class="weatherwidget-io" href="https://forecast7.com/en/29d84n81d28/32080/?unit=us" data-label_1="ST. AUGUSTINE" data-label_2="BEACH WEATHER" data-font="Ubuntu" data-icons="Climacons" data-mode="Forecast" data-days="5" data-theme="pure" >ST. AUGUSTINE BEACH WEATHER</a>
        <script>
          !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
        </script>
      </div>
    </div>
-->
    <div class="card">
      <div class="description">Buoy Swell Combined Polar Spectrum</div>
      <div class="imagecontentonly"><a href="/dynamic/swell_polar_spectrum_combined.png" target="_blank"><img src="/dynamic/swell_polar_spectrum_combined.png"></a></div>
    </div>
    <div class="card">
      <div class="description"><a href="https://cdip.ucsd.edu/m/products/?stn=194p1" target="_blank" rel="noopener noreferrer">Buoy Predictions</a></div>
      <div class="imagecontentonly"><a href="/dynamic/ucsd_forecast.png" target="_blank"><img src="/dynamic/ucsd_forecast.png"></a></div>
    </div>
    <div class="card">
      <div class="description">Moon</div>
      <div class="imagecontentonly"><a href="/dynamic/moon.jpg" target="_blank"><img src="/dynamic/moon.jpg"></a></div>
    </div>
    <div class="card">
      <div class="description">
        <div>Water Temperature at The Pier (<a href="https://www.ndbc.noaa.gov/station_page.php?station=sauf1" target="_blank" rel="noopener noreferrer">SAUF1</a>)</div>
      </div>
      <div class="imagecontentonly"><a href="/dynamic/water_temperature.png" target="_blank"><img src="/dynamic/water_temperature.png"></a></div>
    </div>
    <div class="card">
      <div class="description"><a href="https://tidesandcurrents.noaa.gov/noaatidepredictions.html?id=8720587&units=standard&bdate=20210501&edate=20210531&timezone=LST/LDT&clock=12hour&datum=MLLW&interval=hilo&action=monthlychart" target="_blank" rel="noopener noreferrer">Tide Heights</a></div>
      <div class="imagecontentonly"><a href="/dynamic/tideheights.svg" target="_blank"><img src="/dynamic/tideheights.svg"></a></div>
    </div>
    <div class="card">
      <div class="description">
        <div>About the Weather Station</div>
        <div>GPS: 29&deg;50&apos;48.7&quot;N 81&deg;15&apos;58.9&quot;W; 40 FT</div><!-- (29.846861, -81.266361) -->
      </div>
      <div class="imagecontentonly"><a href="/static/wx-818b519807575cb096fe1197b200327a.jpg" target="_blank"><img src="/static/wx-818b519807575cb096fe1197b200327a.jpg"></a></div>
    </div>
    <div class="card">
      <div class="description">Links</div>
      <div>
        <ul>
          <li><a href="https://www.surf-station.com/" target="_blank">The Surf Station Surf Report</a></li>
          <li><a href="https://www.surf-station.com/north-florida-surf-forecast/" target="_blank">Dean&apos;s North Florida Surf Forecast</a></li>
          <li><a href="https://www.ndbc.noaa.gov/station_page.php?station=41117" target="_blank">St. Augustine Buoy</a></li>
          <li><a href="https://www.ndbc.noaa.gov/station_page.php?station=41009" target="_blank">Canaveral Buoy</a></li>
          <li><a href="https://www.ndbc.noaa.gov/station_page.php?station=41008" target="_blank">Grays Reef Buoy</a></li>
          <li><a href="https://www.ndbc.noaa.gov/obs.shtml?lat=29.709466&lon=-80.659100&zoom=7&type=oceans&status=r&pgm=&op=&ls=n" target="_blank">Check Local Buoys</a></li>
          <li><a href="https://www.ndbc.noaa.gov/data/Forecasts/FZUS52.KJAX.html" target="_blank">Local Marine Forecast</a></li>
          <li><a href="https://www.accuweather.com/en/us/st-augustine/32084/weather-radar/332327" target="_blank" rel="noopener noreferrer">Local Radar</a></li>
          <li><a href="https://cdip.ucsd.edu/" target="_blank" rel="noopener noreferrer">Buoy Data courtesy of CDIP</a></li>
          <li><a href="https://www.surfstationstore.com/"><img src="/static/weather_shop_button-a3ffac88aff6bfb70c536d635fad5ce9.svg"></a></li>
        </ul>
      </div>
    </div>
    <footer>St. Augustine Beach, FL 32080</footer>
    <script src="/static/jquery-3.6.3.min.js"></script>
    <script>
      var $windDirectionHand = null;
      var $windDirectionDisplay = null;
      var $windSpeedDisplay = null;
      var $windInstant = null;
      var $windGustDirectionHand = null;
      var $windGustDirectionDisplay = null;
      var $windGustSpeedDisplay = null;
      var $temperature = null;
      var $humidity = null;
      var $showondata = null;

      function poll_wx_data() {
        $.ajax({
          async: true,
          cache: false,
          dataType: 'json',
          method: 'GET',
          timeout: 2000,
          url: '/dynamic/wx.json'
        }).done(function(wx) {
          $windDirectionHand.attr('transform', 'rotate(' + wx.d + ' 500 500)');
          $windDirectionDisplay.html('From ' + wx.d + '&deg;');
          $windSpeedDisplay.text(wx.w + ' MPH');
          $windInstant.text(new Date(wx.t).toLocaleString('en-US', {timeZone: 'America/New_York'}));
          $windGustDirectionHand.attr('transform', 'rotate(' + wx.gd + ' 500 500)');
          $windGustDirectionDisplay.html('From ' + wx.gd + '&deg;');
          $windGustSpeedDisplay.text(wx.g + ' MPH');
          $temperature.text(wx.f);
          $humidity.text(wx.h);
          $showondata.show();
        }).always(function() {
          setTimeout(poll_wx_data, 4000);
        });
      }

      $(function() {
        $.getJSON('/dynamic/daily.json').done(function(data) {
          $('#firstLight').text(data.firstLight);
          $('#sunrise').text(data.sunrise);
          $('#sunset').text(data.sunset);
          $('#lastLight').text(data.lastLight);
          $('#tides').append('<li>'+ data.tides.join('</li><li>')+'</li>');
          $('#tomorrowstides').append('<li>'+ data.tides_tomorrow.join('</li><li>')+'</li>');
        });

        $.getJSON('/dynamic/buoy.json').done(function(data) {
          $('#buoy_swell_height_feet').text(data.buoy.swell_height_feet);
          $('#buoy_swell_period_secs').text(data.buoy.swell_period_secs);
          $('#buoy_swell_angle_degrees').text(data.buoy.swell_angle_degrees);
          $('#buoy_temperature_fahrenheit').text(data.buoy.temperature_fahrenheit);
          $('#swell_angle_hand').attr('transform', 'rotate(' +  ((parseInt(data.buoy.swell_angle_degrees, 10) + 180) % 360) + ' 500 500)');
        });

        $windDirectionHand = $('#windDirectionHand');
        $windDirectionDisplay = $('#windDirectionDisplay');
        $windSpeedDisplay = $('#windSpeedDisplay');
        $windInstant = $('#windInstant');
        $windGustDirectionHand = $('#windGustDirectionHand');
        $windGustDirectionDisplay = $('#windGustDirectionDisplay');
        $windGustSpeedDisplay = $('#windGustSpeedDisplay');
        $temperature = $('#temperature');
        $humidity = $('#humidity');
        $showondata = $('.showondata');
        poll_wx_data();
      });
    </script>
  </body>
</html>
